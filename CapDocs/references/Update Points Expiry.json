{"openapi":"3.0.0","info":{"title":"Points Expiry API","version":"1.0.0","description":"API for updating points expiry dates."},"servers":[{"url":"{hostname}/v2","variables":{"hostname":{"default":"api.example.com","description":"API hostname (e.g., eu.api.capillarytech.com)"}}}],"security":[{"basicAuth":[]},{"BearerAuth":[],"X-CAP-API-AUTH":[]}],"paths":{"/points/updateExpiry":{"post":{"summary":"Update Points Expiry","description":"Updates expiry dates for points based on customer identifier and transaction reference data.","parameters":[{"$ref":"#/components/parameters/AuthorizationHeader"},{"$ref":"#/components/parameters/XCapApiAuthHeader"},{"$ref":"#/components/parameters/ContentTypeHeader"},{"$ref":"#/components/parameters/AcceptHeader"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PointsExpiryUpdateRequest"}}}},"responses":{"200":{"description":"Successful response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PointsExpiryUpdateSuccessResponse"}}}},"400":{"description":"Bad Request - Validation failed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PointsExpiryUpdateErrorResponse"}}}}}}}},"components":{"securitySchemes":{"BearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"},"X-CAP-API-AUTH":{"type":"apiKey","in":"header","name":"X-CAP-API-AUTH"},"basicAuth":{"type":"http","scheme":"basic"}},"parameters":{"AuthorizationHeader":{"name":"Authorization","in":"header","description":"Bearer token or authentication header","required":true,"schema":{"type":"string"}},"XCapApiAuthHeader":{"name":"X-CAP-API-AUTH","in":"header","description":"Capillary API authentication token","required":false,"schema":{"type":"string"}},"ContentTypeHeader":{"name":"Content-Type","in":"header","description":"Must be application/json","required":false,"schema":{"type":"string","enum":["application/json"]}},"AcceptHeader":{"name":"Accept","in":"header","description":"Must be application/json","required":false,"schema":{"type":"string","enum":["application/json"]}}},"schemas":{"PointsExpiryUpdateRequest":{"type":"object","properties":{"expiryDateUpdateRequest":{"type":"array","description":"List of expiry update requests","items":{"$ref":"#/components/schemas/PointsExpiryUpdateRequestItem"}}},"required":["expiryDateUpdateRequest"]},"PointsExpiryUpdateRequestItem":{"type":"object","properties":{"identifierName":{"type":"string","description":"Customer identifier type (e.g., 'mobile', 'email', 'customerId', 'externalId', 'id')","enum":["mobile","email","customerId","externalId","id"]},"identifierValue":{"type":"string","description":"Customer identifier value"},"programId":{"type":"integer","format":"int64","description":"Loyalty program identifier"},"pointsAwardedRefId":{"type":"integer","format":"int64","description":"Reference ID of the points transaction"},"pointsAwardedRefType":{"type":"string","description":"Type of points award reference","enum":["POINT_AWARDED","POINT_AWARDED_BILL_PROMOTION","POINT_AWARDED_LINEITEM","POINT_AWARDED_LINEITEM_PROMOTION","POINT_AWARDED_CUSTOMER_PROMOTION"]},"currencyName":{"type":"string","description":"Name of the points currency (e.g., 'Main')","default":"POINTS"},"pointCategoryType":{"type":"string","description":"Category of points","enum":["REGULAR","PROMISED"]},"expiryUpdateReasonType":{"type":"string","description":"Type of expiry update (e.g., 'EARLY_EXPIRY', 'EXTEND_EXPIRY')"},"expiryUpdateReasonNote":{"type":"string","description":"Reason for updating expiry date"},"standardMeta":{"$ref":"#/components/schemas/StandardMeta"},"customMeta":{"$ref":"#/components/schemas/CustomMeta"},"expiryDate":{"$ref":"#/components/schemas/ExpiryDate","description":"New expiry details"}},"required":["identifierName","identifierValue","programId","pointsAwardedRefId","pointsAwardedRefType","expiryDate"]},"StandardMeta":{"type":"object","properties":{"who_raised":{"type":"string"},"who_approved":{"type":"string"},"reason_for_trigger":{"type":"string"}}},"CustomMeta":{"type":"object","description":"Custom metadata fields","additionalProperties":{"type":"string"}},"ExpiryDate":{"type":"object","properties":{"expiryType":{"type":"string","description":"Type of expiry","enum":["FIXED_DATE","FIXED_DAYS","FIXED_MONTHS","IMMEDIATE"]},"expiryValue":{"type":"string","description":"Value for expiry (date string or number of days/months)"}},"required":["expiryType","expiryValue"]},"PointsExpiryUpdateSuccessResponse":{"type":"object","properties":{"entity":{"$ref":"#/components/schemas/PointsExpiryUpdateSuccessEntity"},"errors":{"type":"array","items":{"$ref":"#/components/schemas/ErrorDetail"}},"warnings":{"type":"array","items":{"$ref":"#/components/schemas/ErrorDetail"}}}},"PointsExpiryUpdateSuccessEntity":{"type":"object","properties":{"updateCurrencyExpiryDateResponse":{"type":"array","items":{"$ref":"#/components/schemas/UpdateCurrencyExpiryDateResponseItem"}},"failures":{"type":"array","items":{"type":"object"}}}},"UpdateCurrencyExpiryDateResponseItem":{"type":"object","properties":{"customerId":{"type":"integer","format":"int64"},"programId":{"type":"integer","format":"int64"},"success":{"type":"boolean"}}},"PointsExpiryUpdateErrorResponse":{"type":"object","properties":{"entity":{"type":"object","nullable":true},"errors":{"type":"array","items":{"$ref":"#/components/schemas/ErrorDetail"}},"warnings":{"type":"array","items":{"$ref":"#/components/schemas/ErrorDetail"}}}},"ErrorDetail":{"type":"object","properties":{"code":{"type":"integer"},"message":{"type":"string"}}}}}}